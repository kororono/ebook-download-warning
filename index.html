<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Download Warning</title>
    <style>
        /* Basic styles for the page */
        body {
            background-color: black;
            color: white;
            text-align: center;
            font-family: Arial, sans-serif;
        }
        #map {
            height: 300px;
            width: 80%;
            margin: auto;
            border: 2px solid white;
            margin-top: 20px;
        }
    </style>
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <!-- Leaflet JavaScript -->
    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    <script>
        // Function to get the user's IP address and location
        async function fetchIPandLocation() {
            const ipResponse = await fetch('https://api.ipify.org?format=json');
            const ipData = await ipResponse.json();
            document.getElementById('user-ip').innerText = ipData.ip;

            // Get location data based on IP
            const locationResponse = await fetch(`http://ip-api.com/json/${ipData.ip}`);
            const locationData = await locationResponse.json();

            if (locationData.status === "success") {
                document.getElementById('location-info').innerText = `${locationData.city}, ${locationData.regionName}, ${locationData.country}`;
                // Initialize the map with location data
                initMap(locationData.lat, locationData.lon);
            } else {
                document.getElementById('location-info').innerText = "Unable to determine location.";
            }
        }

        // Function to initialize the Leaflet map
        function initMap(latitude, longitude) {
            const map = L.map('map').setView([latitude, longitude], 10); // Sets map to the location
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                maxZoom: 18,
                attribution: 'Â© OpenStreetMap'
            }).addTo(map);
            L.marker([latitude, longitude]).addTo(map).bindPopup('You are here.').openPopup();
        }

        // Function to redirect to the actual download after displaying a warning
        function redirectToDownload() {
            alert("Your IP address has been recorded: " + document.getElementById('user-ip').innerText + ". Do not share this file.");
            window.location.href = "https://example.com/your-download-link.pdf"; // Replace with your actual download link
        }

        // Fetch IP and location on page load
        window.onload = fetchIPandLocation;
    </script>
</head>
<body>
    <h1>Warning!</h1>
    <p>Your IP address <span id="user-ip">[Fetching IP...]</span> has been recorded.</p>
    <p>Your approximate location is <span id="location-info">[Fetching Location...]</span></p>
    <div id="map"></div>
    <button onclick="redirectToDownload()">Continue to Download</button>
</body>
</html>

